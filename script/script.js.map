{"version":3,"file":"bundle.js","sources":["node_modules\\browserify\\node_modules\\browser-pack\\_prelude.js","script\\main.js","script\\options.js","script\\nav.js","script\\mobile.js","script\\dateUtil.js","script\\schedule.js"],"names":["options","require","mobile","nav","dateUtil","schedule","addEventListener","document","getElementById","style","left","scrollX","Array","prototype","diff","a","this","filter","i","indexOf","init","expandOptions","classList","add","innerHTML","contractOptions","remove","toggleOptions","contains","initOptions","opt","isMobile","inputs","getElementsByTagName","localStorage","updateScheduleInterval","activeUpdateInterval","removeItem","length","input","type","event","target","name","checked","parseInt","value","createOptions","data","JSON","parse","sections","forEach","section","hasOwnProperty","platforms","createOptionSection","attachOptionActions","updateSchedule","displayOptionsError","timeout","warn","createOptionSectionTitle","option","createOption","tr","createElement","th","colspan","span","title","appendChild","textContent","tddesc","tdinput","tooltip","description","defaultValue","mobileDefault","default","min","updateUpdateInterval","getElementsByName","enablePeriodNotifications","permission","Notification","window","alert","requestPermission","body","enableDayView","setViewType","viewTypes","DAY","WEEK","scrollTo","keyCode","interceptF5","preventDefault","interceptCtrlR","ctrlKey","metaKey","goPrev","goNext","goCurr","setDoge","enableDoge","download","url","cb","errcb","xmlhttp","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","ontimeout","send","exports","setTitleTitle","titles","split","Math","floor","random","updateUrlParams","urlParams","match","pl","search","decode","s","decodeURIComponent","replace","query","location","substring","exec","getDateFromUrlParams","date","Date","setFullYear","setMonth","setDate","viewType","getMonday","displayDate","getDate","updateSearch","week","curr","getMonth","getYear","getFullYear","toString","substr","param","slice","history","pushState","protocol","host","pathname","hash","replaceState","state","navigator","userAgent","vendor","opera","innerWidth","innerHeight","test","meta","content","class","setDayBeginning","setHours","d","getDay","setUpdateInterval","hidden","opts","hiddenUpdateInterval","hasFocus","inactiveUpdateInterval","seconds","clearInterval","updateScheduleID","setInterval","parseRawSchedules","rawSchedules","schedules","x","shift","str","start","end","push","valueOf","setDisplayDate","time","force","rows","deleteRow","insertRow","createDay","text","warning","display","daySchedule","getDayInfo","col","insertCell","head","headWrapper","days","dateString","prevEnd","index","periodName","makePeriodNameReplacements","replacements","periodTime","lastIndexOf","showPassingPeriods","passing","createPeriod","period","table","row","lunch1","lunch1Time","createSubPeriods","lunch2","lunch2Time","getDateFromString","string","hour","day","id","getScheduleIndex","undefined","parent","startDate","endDate","periodWrapper","height","start1","end1","start2","end2","p1","lunchPassing","p2","w2","setHighlightedPeriod","now","prevDay","prevPeriods","call","getElementsByClassName","prevPeriod","periodLength","removeChild","cells","periods","p","round","currPeriods","diff1","diff2","sendNotification","notificationDuration","duration","notification","setTimeout","close"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\r\n * Primary script for the Harker Bell Schedule\r\n * Hosted at http://harkerdev.github.io/bellschedule\r\n**/\r\n\r\nvar options = require(\"./options.js\");\r\nvar mobile = require(\"./mobile.js\");\r\nvar nav = require(\"./nav.js\");\r\nvar dateUtil = require(\"./dateUtil.js\");\r\nvar schedule = require(\"./schedule.js\");\r\n\r\n/**\r\n * CSS things\r\n */\r\naddEventListener(\"scroll\", function(event) {\r\n\tdocument.getElementById(\"header\").style.left = scrollX + \"px\";\r\n});\r\n\r\n/**\r\n * Returns an array of values in the array that aren't in a.\r\n */\r\nArray.prototype.diff = function(a) {\r\n\treturn this.filter(function(i) {return a.indexOf(i) < 0;});\r\n};\r\n\r\n\r\n/**\r\n * Parses schedules, creates schedule for correct week, sets title title on page load.\r\n */\r\naddEventListener(\"load\", function(event) {\r\n\tmobile.init();\r\n\r\n\tnav.init();\r\n\r\n\tschedule.init();\r\n\r\n\t//updateSchedule();\r\n\t//updateClock();\r\n\t\r\n\toptions.init();\r\n});\r\n","var options = exports.options = {}; //needs to be initialized before requiring schedule\n\n\nvar mobile = require(\"./mobile.js\");\nvar nav = require(\"./nav.js\");\nvar schedule = require(\"./schedule.js\");\n\nvar isMobile = mobile.isMobile;\n\n\n\nexports.init = function() {\n\tdownload(\"options.json\", createOptions, displayOptionsError);\n};\n\n/**\n * Expands the options div and changes the options arrow to point down and to the right.\n */\nfunction expandOptions() {\n\tdocument.getElementById(\"options\").classList.add(\"expanded\");\n\tdocument.getElementById(\"optionsArrow\").innerHTML = \"&#8600;\";\n}\n/**\n * Contracts the options div and changes the options arrow to point up and to the left.\n */\nfunction contractOptions() {\n\tdocument.getElementById(\"options\").classList.remove(\"expanded\");\n\tdocument.getElementById(\"optionsArrow\").innerHTML = \"&#8598;\";\n}\n/**\n * Toggles the options div between extended and contracted and updates options arrow accordingly.\n */\nfunction toggleOptions() {\n\tif(document.getElementById(\"options\").classList.contains(\"expanded\"))\n\t\tcontractOptions();\n\telse expandOptions();\n\n}\n\n/**\n * Initializes automatic option saving and sets options to previously-saved values, if any.\n * If no previous saved value exists, sets current (default) value as saved value.\n */\nfunction initOptions() {\n\tvar opt = document.getElementById(\"options\");\n\topt.addEventListener(\"mouseover\", expandOptions);\n\topt.addEventListener(\"mouseout\", contractOptions);\n\n\tif(isMobile) opt.classList.add(\"mobile\");\n\n\tdocument.getElementById(\"optionsArrow\").addEventListener(\"click\", toggleOptions);\n\n\tvar inputs = opt.getElementsByTagName(\"input\");\n\n\tif(localStorage.updateScheduleInterval) {\n\t\t//rename key\n\t\tlocalStorage.activeUpdateInterval=localStorage.updateScheduleInterval;\n\t\tlocalStorage.removeItem(\"updateScheduleInterval\");\n\t}\n\n\tfor(var i=0; i<inputs.length; i++)\n\t{\n\t\tvar input = inputs[i];\n\t\t//special cases because localStorage saves values as strings\n\t\tif(input.type==\"checkbox\") {\t\t\t\t\t\t\t\t\t\t\t//booleans\n\t\t\tinput.addEventListener(\"change\", function(event) {\n\t\t\t\toptions[event.target.name] = localStorage[event.target.name] = event.target.checked;\n\t\t\t});\n\n\t\t\tif(localStorage[input.name]) options[input.name] = input.checked = localStorage[input.name]==\"true\";\n\t\t\telse options[input.name] = localStorage[input.name] = input.checked;\n\t\t}\n\t\telse if(input.type==\"number\") {\t\t\t\t\t\t\t\t\t\t//numbers\n\t\t\tinput.addEventListener(\"change\", function(event) {\n\t\t\t\toptions[event.target.name] = parseInt(localStorage[event.target.name] = event.target.value);\n\t\t\t});\n\n\t\t\tif(localStorage[input.name]) options[input.name] = parseInt(input.value = localStorage[input.name]);\n\t\t\telse options[input.name] = parseInt(localStorage[input.name] = input.value);\n\t\t}\n\t\telse {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//strings\n\t\t\tinput.addEventListener(\"change\", function(event) {\n\t\t\t\toptions[event.target.name] = localStorage[event.target.name] = event.target.value;\n\t\t\t});\n\n\t\t\tif(localStorage[input.name]) options[input.name] = input.value = localStorage[input.name];\n\t\t\telse options[input.name] = localStorage[input.name] = input.value;\n\t\t}\n\t}\n}\n\n/**\n * Creates options in the options div.\n */\nfunction createOptions(data) {\n\t// just assume the file has everything for now\n\tJSON.parse(data).sections.forEach(function(section) {\n\t\tif(!section.hasOwnProperty(\"platforms\") ||\n\t\t\t((isMobile && section.platforms.indexOf(\"mobile\") >= 0) || !isMobile)) {\n\t\t\tcreateOptionSection(section);\n\t\t}\n\t});\n\n\tinitOptions();\n\tattachOptionActions();\n\n\tschedule.updateSchedule(null, true);\n}\n\n/**\n * Displays error about retrieving schedule.\n */\nfunction displayOptionsError(timeout, status) {\n\tschedule.updateSchedule();\n\t\n\tif(timeout) {\n\t\twarn(\"Retrieval of options.json timed out!\");\n\t} else {\n\t\twarn(\"Something went wrong while retrieving options.json!\");\n\t}\n}\n\n/**\n * Create and insert options section.\n */\nfunction createOptionSection(section) {\n\tcreateOptionSectionTitle(section);\n\tsection.options.forEach(function(option) {\n\t\tif(!option.hasOwnProperty(\"platforms\") ||\n\t\t   ((isMobile && option.platforms.indexOf(\"mobile\") >= 0) || !isMobile)) {\n\t\t\tcreateOption(option);\n\t\t}\n\t});\n}\n\n/**\n * Create and insert options section title.\n */\nfunction createOptionSectionTitle(section) {\n\tvar tr = document.createElement(\"tr\");\n\tvar th = document.createElement(\"th\");\n\tth.colspan = 2;\n\tif(section.hasOwnProperty(\"tooltip\")) {\n\t\tvar span = document.createElement(\"span\");\n\t\tspan.title = section[\"tooltip\"];\n\t\tspan.innerHTML = section.name + '<sup class=\"tooltipIndicator\">?</sup>';\n\t\tth.appendChild(span);\n\t} else {\n\t\tth.textContent = section.name;\n\t}\n\ttr.appendChild(th);\n\tdocument.getElementById(\"optionsContent\").appendChild(tr);\n}\n\n/**\n * Create and insert option into options.\n */\nfunction createOption(option) {\n\tvar tr = document.createElement(\"tr\");\n\tvar tddesc = document.createElement(\"td\");\n\tvar tdinput = document.createElement(\"td\");\n\tif(option.hasOwnProperty(\"tooltip\")) {\n\t\tvar span = document.createElement(\"span\");\n\t\tspan.title = option.tooltip;\n\t\tspan.innerHTML = option.description + '<sup class=\"tooltipIndicator\">?</sup>:';\n\t\ttddesc.appendChild(span);\n\t} else {\n\t\ttddesc.textContent = option.description + \":\";\n\t}\n\tvar input = document.createElement(\"input\");\n\tinput.name = option.name;\n\tinput.type = option.type;\n\tvar defaultValue = (isMobile && option.hasOwnProperty(\"mobileDefault\")) ? option.mobileDefault : option.default; //choose desktop or mobile default value\n\tif(input.type == \"number\") {\n\t\tinput.min = 0; //may as well keep this here until any options can take negative\n\t\tinput.value = defaultValue;\n\t} else if(input.type == \"checkbox\") {\n\t\tif(defaultValue) input.checked = \"checked\";\n\t}\n\ttdinput.appendChild(input);\n\ttr.appendChild(tddesc);\n\ttr.appendChild(tdinput);\n\tdocument.getElementById(\"optionsContent\").appendChild(tr);\n}\n\n/**\n * Creates event listeners for option-specific actions on option change and applies option-specific actions on page load.\n */\nfunction attachOptionActions() {\n\tschedule.updateUpdateInterval();\n\tdocument.getElementsByName(\"activeUpdateInterval\")[0].addEventListener(\"change\", function(event) {\n\t\tschedule.updateUpdateInterval();\n\t});\n\tdocument.getElementsByName(\"showPassingPeriods\")[0].addEventListener(\"change\", function(event) {\n\t\tschedule.updateSchedule(null,true);\n\t});\n\n\tdocument.getElementsByName(\"enablePeriodNotifications\")[0].addEventListener(\"change\", function(event) {\n\t\tif(options.enablePeriodNotifications) {\n\t\t\tvar permission = Notification.permission;\n\t\t\tif(!(\"Notification\" in window)) {\n\t\t\t\talert(\"This browser does not support desktop notifications.\");\n\t\t\t} else if(permission == \"denied\") {\n\t\t\t\talert(\"Please allow desktop notifications for this site to enable this feature.\");\n\t\t\t} else if(permission == \"default\") {\n\t\t\t\tNotification.requestPermission();\n\t\t\t}\n\t\t}\n\t});\n\n\tdocument.body.classList.add(options.enableDayView ? \"day\" : \"week\");\n\tnav.setViewType(options.enableDayView ? nav.viewTypes.DAY : nav.viewTypes.WEEK);\n\tdocument.getElementsByName(\"enableDayView\")[0].addEventListener(\"change\", function(event) {\n\t\tschedule.updateSchedule(null, true);\n\t\t\n\t\tdocument.body.classList.remove(\"week\");\n\t\tdocument.body.classList.remove(\"day\");\n\t\t\n\t\tnav.setViewType(options.enableDayView ? nav.viewTypes.DAY : nav.viewTypes.WEEK);\n\t\t\n\t\tnav.setViewType(options.enableDayView ? \"day\" : \"week\");\n\t\t\n\t\tscrollTo(0,0); //scroll back to top-left corner\n\t});\n\n\tif(!isMobile) {\n\t\tdocument.addEventListener(\"keydown\", function(event) {\n\t\t\tswitch (event.keyCode){\n\t\t\t\tcase 116 : //F5\n\t\t\t\t\tif(options.interceptF5){\n\t\t\t\t\t\t//enabled\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tschedule.updateSchedule();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 82 : //R key\n\t\t\t\t\tif(options.interceptCtrlR && (event.ctrlKey||event.metaKey)){\n\t\t\t\t\t\t//enabled and control/cmd (meta)\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tschedule.updateSchedule();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 37 : //Left arrow\n\t\t\t\t\tgoPrev();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 39 : //Right arrow\n\t\t\t\t\tgoNext();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 40 : //Down arrow\n\t\t\t\t\tgoCurr();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tsetDoge(options.enableDoge);\n\t\tdocument.getElementsByName(\"enableDoge\")[0].addEventListener(\"change\", function(event) {\n\t\t\tsetDoge(event.target.checked);\n\t\t});\n\t}\n}\n\n/**\n * Retrieve file data via XMLHttpRequest.\n *\n * cb is for successful retrieval and takes a String as a parameter.\n * errcb is for an error on retrieval and takes:\n *    1. a boolean representing whether or not the error was a timeout.\n *    2. an integer representing the status of the response (this is null on timeout).\n */\nfunction download(url, cb, errcb) {\n\tvar xmlhttp = new XMLHttpRequest();\n\txmlhttp.open(\"GET\", url, true);\n\txmlhttp.onreadystatechange = function() {\n\t\tif(xmlhttp.readyState == 4) {\n\t\t\tif(xmlhttp.status == 200) {\n\t\t\t\tcb(xmlhttp.responseText);\n\t\t\t} else if(errcb) {\n\t\t\t\terrcb(false, xmlhttp.status);\n\t\t\t}\n\t\t}\n\t};\n\txmlhttp.ontimeout = function() {\n\t\terrcb(true, null);\n\t};\n\txmlhttp.send();\n}\n","var dateUtil = require(\"./dateUtil.js\");\n\n\nvar urlParams; //object with GET variables as properties and their respective values as values\nvar viewType;\n\n\n/**\n * Gets GET variables from URL and sets them as properties of the urlParams object.\n * Then updates the state of the current history entry with the appropriate week.\n */\n\n/**\n * Adds appropriate event listeners to items in the schedule title.\n */\nexports.init = function() {\n\t//decode GET vars in URL\n\tupdateUrlParams();\n\t\n\t//update history state\n\twindow.history.replaceState( getDateFromUrlParams() );\n\t\n\tdocument.getElementById(\"header\").addEventListener(\"click\", setTitleTitle);\n\tdocument.getElementById(\"leftArrow\").addEventListener(\"click\", goPrev);\n\tdocument.getElementById(\"rightArrow\").addEventListener(\"click\", goNext);\n\n\tdocument.getElementById(\"refresh\").addEventListener(\"click\", function(){ updateSchedule(null,true); });\n\n\tsetTitleTitle();\n};\n\nexports.setViewType = function(type) {\n\tviewType = type;\n}\n\nvar viewTypes = exports.viewTypes = {\n\tDAY: \"day\",\n\tWEEK: \"week\"\n}\n\n\n/**\n * Event listener for navigating through history.\n * (onload event will not fire when navigating through history items pushed by history.pushState, because the page does not reload)\n */\naddEventListener(\"popstate\", function(event) {\n\tupdateUrlParams();\n\tupdateSchedule(event.state);\n});\n\n/**\n * Sets the title of the title to a random line from the title titles list\n */\nfunction setTitleTitle() {\n\tvar titles = document.getElementById(\"titleTitles\").textContent.split(\"\\n\");\n\tdocument.getElementById(\"title\").title=titles[Math.floor(Math.random()*titles.length)];\n}\n\n/**\n * Updates urlParams object based on the GET variables in the URL.\n * (variables as properties and values as values)\n */\nfunction updateUrlParams() {\n\turlParams = {};\n\t\n\tvar match,\n\t\tpl = /(?!^)\\+/g,  //regex for replacing non-leading + with space\n\t\tsearch = /([^&=]+)=?([^&]*)/g,\n\t\tdecode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); },\n\t\tquery = location.search.substring(1);\n\t\n\twhile (match = search.exec(query))\n\t\turlParams[decode(match[1])] = decode(match[2]);\n}\n\n/**\n * Returns a Date object based on the current urlParams (GET variables in the URL).\n * If any part of the date is not specified, defaults to the current date/month/year.\n * If in week view, uses the Monday of the week instead of the day.\n */\nfunction getDateFromUrlParams() {\n\tvar date = new Date();\n\t\n\tif(urlParams[\"y\"]>0) date.setFullYear(urlParams[\"y\"]);\n\tif(urlParams[\"m\"]>0) date.setMonth(urlParams[\"m\"]-1);\n\tif(urlParams[\"d\"]>0) date.setDate(urlParams[\"d\"]);\n\t\n\tif(viewType == viewTypes.WEEK) date = dateUtil.getMonday(date);\n\t\n\treturn date;\n}\nexports.getDateFromUrlParams = getDateFromUrlParams; //TODO: remove web of dependencies\n\n/**\n * Navigates schedule to previous date.\n */\nfunction goPrev() {\n\tvar date = new Date(displayDate);\n\tdate.setDate(date.getDate() - (viewType == viewTypes.DAY ? 1 : 7));\n\tupdateSchedule(date);\n\t\n\tupdateSearch(date);\n}\n\n/**\n * Navigates schedule to next date.\n */\nfunction goNext() {\n\tvar date = new Date(displayDate);\n\tdate.setDate(date.getDate() + (viewType == viewTypes.DAY ? 1 : 7));\n\tupdateSchedule(date);\n\t\n\tupdateSearch(date);\n}\n\n/**\n * Navigates schedule to current date.\n */\nfunction goCurr() {\n\tvar date = new Date();\n\tupdateSchedule(date);\n\n\tupdateSearch(date);\n}\n\n/**\n * Updates GET variables and urlParams to reflect date in week and pushes corresponding history state.\n */\nfunction updateSearch(week, noHistory) {\n\tvar curr = new Date();\n\t\n\tif(viewType == viewTypes.WEEK) curr = dateUtil.getMonday(curr);\n\t\n\tif(week.getDate() != curr.getDate()) {\n\t\turlParams[\"m\"] = week.getMonth()+1;\n\t\turlParams[\"d\"] = week.getDate();\n\t} else {\n\t\tdelete urlParams[\"m\"];\n\t\tdelete urlParams[\"d\"];\n\t}\n\tif(week.getYear() != curr.getYear()) urlParams[\"y\"] = week.getFullYear().toString().substr(-2);\n\telse delete urlParams[\"y\"];\n\t\n\tvar search = \"?\";\n\tfor(var param in urlParams) search += param + \"=\" + urlParams[param] + \"&\";\n\tsearch = search.slice(0,-1);\n\t\n\thistory.pushState(week, document.title, location.protocol + \"//\" + location.host + location.pathname + search + location.hash);\n}\n","\n/**\n * Function to detect whether the page is being displayed on a mobile device.\n * Currently checks if the useragent/vendor matches a regex string for mobile phones.\n */\nfunction isMobile() {\n\tvar a = navigator.userAgent || navigator.vendor || window.opera;\n\tif(window.innerWidth <= 800 && window.innerHeight <= 600) return true;\n\treturn /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4));\n}\n\n\nexports.init = function() {\n\tvar mobile = exports.isMobile = isMobile();\n\tif(mobile) {\n\t\tvar meta = document.createElement(\"meta\");\n\t\tmeta.name = \"viewport\";\n\t\tmeta.content = 'user-scalable=no, initial-scale=1.0, maximum-scale=1.0';\n\t\tdocument.getElementsByTagName(\"head\")[0].appendChild(meta);\n\t\tdocument.getElementsByTagName(\"body\")[0].class = \"mobile\";\n\t}\n};\n\n","/**\n * Returns the Monday of next week if date is Saturday; else returns the Monday of that week\n */\nexports.getMonday = function(d) {\n\tvar date = new Date(d);\n\tif(date.getDay()>=6) date.setDate(date.getDate()+2); //set date to next Monday if today is Saturday\n\telse date.setDate(date.getDate()-date.getDay()+1); //else set date Monday of this week\n\tsetDayBeginning(date); //set to beginning of day\n\treturn date;\n}\n\n/**\n * Sets given date to beginning of the day (12:00 AM).\n */\nfunction setDayBeginning(date) {\n\tdate.setHours(0,0,0,0);\n}\nexports.setDayBeginning = setDayBeginning;","var nav = require(\"./nav.js\");\nvar dateUtil = require(\"./dateUtil.js\");\nvar options = require(\"./options.js\");\nvar opts = options.options;\n\n/**\n * Constants\n */\nvar days = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"]; //days of the week in string form\nvar schedules; //array of schedules (each schedule is an array in this array\n\n/**\n * Globals\n */\nvar displayDate; //beginning of time period currently being displayed by the schedule\n\nvar hasFocus = true; //document.hasFocus() seems to be unreliable; assumes window has focus on page load\n\nvar updateScheduleID; //ID of interval of updateSchedule\n\nexports.init = function() {\n\tdocument.addEventListener(\"visibilitychange\", function(event) {\n\t\tif(!document.hidden) { //only slightly redundant; on un-minimize, document gains visibility without focus\n\t\t\tupdateSchedule();\n\t\t\t// updateClock();\n\t\t}\n\t\tupdateUpdateInterval();\n\t});\n\n\taddEventListener(\"focus\", function(event) {\n\t\tupdateSchedule();\n\t\t//updateClock();\n\n\t\thasFocus = true;\n\t\tupdateUpdateInterval();\n\t});\n\taddEventListener(\"blur\", function(event) {\n\t\thasFocus = false;\n\t\tupdateUpdateInterval();\n\t});\n\t\n\t\n\tparseRawSchedules();\n};\n\n//exports.setHiddenUpdateInterval = function(interval) {\n//\topts.hiddenUpdateInterval = interval;\n//};\n//exports.setActiveUpdateInterval = function(interval) {\n//\topts.activeUpdateInterval = interval;\n//};\n//exports.setInactiveUpdateInterval = function(interval) {\n//\topts.inactiveUpdateInterval = interval;\n//};\n\n/**\n * Sets the correct update interval based on the current state (focus and visibility) of the document.\n */\nfunction updateUpdateInterval() {\n\tif(document.hidden) setUpdateInterval(opts.hiddenUpdateInterval); //assume that hidden implies no focus\n\telse if(hasFocus) setUpdateInterval(opts.activeUpdateInterval);\n\telse setUpdateInterval(opts.inactiveUpdateInterval);\n}\nexports.updateUpdateInterval = updateUpdateInterval;\n\n/**\n * Updates the interval for automatically refreshing the page.\n * seconds is the new interval in seconds.\n */\nfunction setUpdateInterval(seconds) {\n\tclearInterval(updateScheduleID);\n\tif(seconds>0)\n\t\tupdateScheduleID = setInterval(function() {\n\t\t\t//updateClock();\n\t\t\tupdateSchedule();\n\t\t}, seconds * 1000); //convert to milliseconds\n\telse updateScheduleID = null;\n}\n\n/**\n * Parses raw schedule in body of page into schedule array\n * Code is questionable\n */\nfunction parseRawSchedules() {\n\tvar rawSchedules=document.getElementById(\"schedules\").textContent.split(\"\\n\"); //get raw schedule text\n\tschedules = new Array();\n\tvar x=0; //index in schedules\n\tschedules[0] = new Array(); //create array of special schedule days\n\n\twhile(rawSchedules.length>0)\n\t{\n\t\t//loop through all lines in raw schedule text\n\t\tif(rawSchedules[0].length==0)\n\t\t{\n\t\t\t//if line is empty, move to next index in schedules\n\t\t\tschedules[++x] = new Array(); //could probably use id as index instead, or just properties\n\t\t\trawSchedules.shift();\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//if line has text, save in current location in schedules\n\t\t\tvar str = rawSchedules.shift();\n\t\t\tif(x==0 && str.indexOf(\"|\")>=0)\n\t\t\t{\n\t\t\t\t//behavior for blocks of dates with the same schedule\n\t\t\t\tvar start = new Date(str.substring(0,str.indexOf(\"|\")));\n\t\t\t\tvar end = new Date(str.substring(str.indexOf(\"|\")+1,str.indexOf(\"\\t\")));\n\t\t\t\tfor(;start<=end;start.setDate(start.getDate()+1)){\n\t\t\t\t\tschedules[0].push(start.getMonth().valueOf()+1+\"/\"+start.getDate()+\"/\"+start.getFullYear().toString().substr(-2)+str.substring(str.indexOf(\"\\t\")));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse schedules[x].push(str);\n\t\t}\n\t}\n}\n\n/**\n * Displays schedule of the week of the given date/time\n */\nfunction setDisplayDate(time, force) {\n\tvar date = (time ? new Date(time) : nav.getDateFromUrlParams()); //variable to keep track of current day in loop\n\n\tdateUtil.setDayBeginning(date);\n\n\tif(force || !displayDate || (date.valueOf()!=displayDate.valueOf())) {\n\t\tvar schedule = document.getElementById(\"schedule\"); //get schedule table\n\n\t\tdisplayDate = new Date(date);\n\n\t\tif(dateUtil.getMonday(date) > dateUtil.getMonday(new Date()))\n\t\t\twarn(\"This is a future date, so the schedule may be incorrect. (In particular, special/alternate schedules may be missing.)\"); //display warning if date is in the future\n\t\telse warn(\"\"); //else display message\n\n\t\t/*\n\t\tif(date.valueOf()==dateUtil.getMonday(new Date()).valueOf()) document.getElementById(\"currWeek\").style.display = \"none\"; //hide back to current week button on current week\n\t\telse document.getElementById(\"currWeek\").style.display = \"inline\"; //else show the button\n\t\t*/\n\t\twhile(schedule.rows.length) schedule.deleteRow(-1); //clear existing weeks (rows); there should only be one, but just in case...\n\n\t\tvar week = schedule.insertRow(-1); //create new week (row)\n\n\t\tif(!opts.enableDayView) {\n\t\t\tdate = dateUtil.getMonday(date);\n\t\t\tfor(var d=0;d<5;d++) {\n\t\t\t\t//for each day Monday through Friday (inclusive)\n\t\t\t\tcreateDay(week, date);\n\n\t\t\t\tdate.setDate(date.getDate()+1); //increment day\n\t\t\t}\n\t\t} else createDay(week, date);\n\t}\n}\n\n\n/**\n * Displays the given warning or hides the warning div if no warning text is given.\n */\nfunction warn(text) {\n\tvar warning = document.getElementById(\"warning\")\n\t\n\tif(text) warning.style.display = \"block\";\n\telse warning.style.display = \"none\";\n\t\n\twarning.innerHTML = text;\n}\n\n/**\n * Creates the day for the given date and appends it to the given week\n */\nfunction createDay(week, date) {\n\tvar daySchedule = getDayInfo(date); //get schedule for that day\n\n\tvar col = week.insertCell(-1); //create cell for day\n\tcol.date = date.valueOf(); //store date in cell element\n\n\tif(date.getMonth()==9 && date.getDate()==31) //check Halloween\n\t\tcol.classList.add(\"halloween\");\n\n\tvar head = document.createElement(\"div\"); //create header div in cell\n\thead.classList.add(\"head\");\n\tvar headWrapper = document.createElement(\"div\");\n\theadWrapper.classList.add(\"headWrapper\");\n\theadWrapper.innerHTML = days[date.getDay()] + \"<div class=\\\"headDate\\\">\" + daySchedule.dateString + /*\" (\" + daySchedule.id + \")*/\"</div>\"; //Portion commented out represents schedule id of that day\n\thead.appendChild(headWrapper);\n\tcol.appendChild(head);\n\n\tvar prevEnd = \"8:00\"; //set start of day to 8:00AM\n\n\tif(daySchedule.index > 0) { //populates cell with day's schedule (a bit messily)\n\t\tfor(var i=1;i<schedules[daySchedule.index].length;i++) {\n\t\t\tvar text = schedules[daySchedule.index][i];\n\t\t\tvar periodName = makePeriodNameReplacements(text.substring(0,text.indexOf(\"\\t\")), daySchedule.replacements);\n\t\t\tvar periodTime = text.substring(text.indexOf(\"\\t\")+1);\n\t\t\t\n\n\t\t\tvar start = periodTime.substring(0,periodTime.indexOf(\"-\"));\n\t\t\tvar end = periodTime.substring(periodTime.lastIndexOf(\"-\")+1);\n\n\t\t\tif(opts.showPassingPeriods){\n\t\t\t\tvar passing = document.createElement(\"div\");\n\t\t\t\tpassing.classList.add(\"period\");\n\t\t\t\tcreatePeriod(passing,\"\",prevEnd,start,date);\n\t\t\t\tcol.appendChild(passing);\n\t\t\t}\n\n\t\t\tprevEnd = end;\n\n\t\t\tvar period = document.createElement(\"div\");\n\t\t\tperiod.classList.add(\"period\");\n\n\t\t\tif(periodName.indexOf(\"|\")>=0) {\n\t\t\t\t//handle split periods (i.e. lunches)\n\t\t\t\tvar table = document.createElement(\"table\");\n\t\t\t\ttable.classList.add(\"lunch\");\n\t\t\t\tvar row = table.insertRow(-1);\n\n\t\t\t\tvar lunch1 = row.insertCell(-1);\n\t\t\t\tvar lunch1Time = periodTime.substring(0,periodTime.indexOf(\"||\"));\n\n\t\t\t\tcreateSubPeriods(\n\t\t\t\t\t\tlunch1,\n\t\t\t\t\t\tperiodName.substring(0,periodName.indexOf(\"||\")),\n\t\t\t\t\t\tstart,\n\t\t\t\t\t\tlunch1Time.substring(lunch1Time.indexOf(\"-\")+1,lunch1Time.indexOf(\"|\")),\n\t\t\t\t\t\tlunch1Time.substring(lunch1Time.indexOf(\"|\")+1,lunch1Time.lastIndexOf(\"-\")),\n\t\t\t\t\t\tend,\n\t\t\t\t\t\tdate\n\t\t\t\t);\n\n\t\t\t\tvar lunch2 = row.insertCell(-1);\n\t\t\t\tvar lunch2Time = periodTime.substring(periodTime.indexOf(\"||\")+2);\n\n\t\t\t\tcreateSubPeriods(\n\t\t\t\t\t\tlunch2,\n\t\t\t\t\t\tperiodName.substring(periodName.indexOf(\"||\")+2),\n\t\t\t\t\t\tstart,\n\t\t\t\t\t\tlunch2Time.substring(lunch2Time.indexOf(\"-\")+1,lunch2Time.indexOf(\"|\")),\n\t\t\t\t\t\tlunch2Time.substring(lunch2Time.indexOf(\"|\")+1,lunch2Time.lastIndexOf(\"-\")),\n\t\t\t\t\t\tend,\n\t\t\t\t\t\tdate\n\t\t\t\t);\n\n\t\t\t\tperiod.appendChild(table);\n\t\t\t}\n\t\t\telse createPeriod(period,periodName,start,end,date);\n\t\t\tcol.appendChild(period);\n\t\t}\n\t}\n}\n\n/**\n * Returns new name for period based on array of replacements.\n * If the current period name is listed in the array of replacements, returns the new, replaced name; otherwise, returns current name.\n * replacements is an array of strings of the form \"OldName->NewName\"\n */\nfunction makePeriodNameReplacements(periodName, replacements) {\n\tif(replacements.length > 0) {\n\t\tfor(var i=0;i<replacements.length;i++) {\n\t\t\tif(!replacements[i].indexOf(periodName))\n\t\t\t\treturn replacements[i].substring(replacements[i].indexOf(\"->\")+2);\n\t\t}\n\t}\n\treturn periodName;\n}\n\n\n\n/**\n * Takes in a date and a string of form \"hh:MM\" and turns it into a time on the day of the given date.\n * Assumes hours less than 7 are PM and hours 7 or greater are AM.\n */\nfunction getDateFromString(string, date) {\n\tvar hour = string.substring(0,string.indexOf(\":\"));\n\tvar min = string.substring(string.indexOf(\":\")+1);\n\tif(hour<7) hour = parseInt(hour,10)+12; //assumes hours less than seven are PM and hours 7 or greater are AM\n\treturn new Date(date.getFullYear(),date.getMonth(),date.getDate(),hour,min);\n}\n\n/**\n * For given day, returns index of schedule id in schedules, schedule id, and formatted date (mm/dd/yy).\n * Schedule id index is 0 if not found in schedules.\n */\nfunction getDayInfo(day) {\n\tvar dateString = day.getMonth().valueOf()+1 + \"/\" + day.getDate().valueOf() + \"/\" + day.getFullYear().toString().substr(-2); //format in mm/dd/YY\n\n\tvar id;\n\tvar index = 0;\n\tvar replacements = [];\n\t\n\tfor(var i=0;i<schedules[0].length;i++) //search for special schedule on day\n\t\tif(!schedules[0][i].indexOf(dateString)){\n\t\t\t//found special schedule\n\t\t\tif(schedules[0][i].indexOf(\"[\") >= 0) { //check for period replacements\n\t\t\t\t//cut replacements and space character out of id and save separately\n\t\t\t\tid = schedules[0][i].substring(schedules[0][i].indexOf(\"\\t\")+1,schedules[0][i].indexOf(\"[\")-1)\n\t\t\t\treplacements = schedules[0][i].substring(schedules[0][i].indexOf(\"[\")+1,schedules[0][i].indexOf(\"]\")).split(\",\");\n\t\t\t} else {\n\t\t\t\t// no replacements to be made\n\t\t\t\tid = schedules[0][i].substring(schedules[0][i].indexOf(\"\\t\")+1);\n\t\t\t}\n\t\t\t\n\t\t\tindex = getScheduleIndex(id);\n\t\t}\n\t\n\tif(id === undefined) { //no special schedule found\n\t\tid = day.getDay();\n\t\tif(id==0 || id==6) index = id = 0; //no school on weekends\n\t\telse index = id; //default schedule for that day\n\t}\n\t\n\treturn { \"index\": index, \"id\": id, \"dateString\": dateString, \"replacements\": replacements };\n}\n\n/**\n * Gets the index in the list of schedules of the schedule with the given schedule id (or 0 if no matching schedules were found)\n */\nfunction getScheduleIndex(id) {\n\tif(id==0) return 0; //schedule id 0 represents no school\n\tfor(var i=1;i<schedules.length;i++) { //find index of schedule id\n\t\tif(id==schedules[i][0]) return i; //found specified schedule id\n\t}\n\treturn 0; //couldn't find specified schedule\n}\n\n/**\n * Creates and returns a new period wrapper with the given content and start/end times.\n * Also applies any special properties based on period length (text on single line if too short, block period if longer than regular).\n */\nfunction createPeriod(parent, name, start, end, date){\n\tstartDate = getDateFromString(start,date);\n\tendDate = getDateFromString(end,date);\n\n\tvar periodWrapper = document.createElement(\"div\");\n\tperiodWrapper.classList.add(\"periodWrapper\");\n\tperiodWrapper.periodName = name;\n\tperiodWrapper.start = startDate;\n\tperiodWrapper.end = endDate;\n\n\tvar length = (endDate-startDate)/60000;\n\n\tif(length > 0) {\n\t\tperiodWrapper.style.height = (length-1) + \"px\"; //minus 1 to account for 1px border\n\n\t\tif(length >= 15) {\n\t\t\tif(name) periodWrapper.innerHTML = name + (length<30 ? \" \" : \"<br />\") + start + \" – \" + end;\n\t\t\tif(length>50 && !name.indexOf(\"P\")) //handle block periods (class=long, i.e. bold text)\n\t\t\t\tperiodWrapper.classList.add(\"long\");\n\t\t}\n\n\treturn parent.appendChild(periodWrapper);\n\t}\n}\n\n/**\n * Creates and appends two new sub-periods and passing period to parent period with given start and end times.\n */\nfunction createSubPeriods(parent, name, start1, end1, start2, end2, date) {\n\tvar p1 = document.createElement(\"div\");\n\tp1.classList.add(\"period\");\n\tcreatePeriod(\n\t\t\tp1,\n\t\t\tname.substring(0,name.indexOf(\"|\")),\n\t\t\tstart1,\n\t\t\tend1,\n\t\t\tdate);\n\tparent.appendChild(p1);\n\n\tif(opts.showPassingPeriods) {\n\t\tvar lunchPassing = document.createElement(\"div\");\n\t\tlunchPassing.classList.add(\"period\");\n\t\tcreatePeriod(lunchPassing,\"\",end1,start2,date);\n\t\tparent.appendChild(lunchPassing);\n\t}\n\n\tvar p2 = document.createElement(\"div\");\n\tp2.classList.add(\"period\");\n\tvar w2 = document.createElement(\"div\");\n\tw2.classList.add(\"periodWrapper\");\n\tcreatePeriod(\n\t\t\tp2,\n\t\t\tname.substring(name.indexOf(\"|\")+1),\n\t\t\tstart2,\n\t\t\tend2,\n\t\t\tdate);\n\tparent.appendChild(p2);\n}\n\n/**\n * Highlights given date/time on the schedule; defaults to now if none is given\n */\nfunction setHighlightedPeriod(time) {\n\t//set default time argument\n\tif(!time) time = Date.now();\n\n\t//set date based on time (for finding day to highlight)\n\tvar date = new Date(time);\n\tdate.setHours(0,0,0,0);\n\n\t//clear previous highlighted day/periods\n\t//TODO: maybe it would be better to not clear highlights when nothing needs to be changed.\n\tvar prevDay = document.getElementById(\"today\");\n\tvar prevPeriods = [];\n\tif(prevDay){\n\t\t//clear previous highlighted periods\n\t\tprevPeriods = Array.prototype.slice.call(prevDay.getElementsByClassName(\"now\")); //get copy of array, not reference to it (needed to check for period changes later)\n\n\t\tfor(var i=prevPeriods.length-1;i>=0;i--){\n\t\t\tvar prevPeriod = prevPeriods[i];\n\t\t\tprevPeriod.classList.remove(\"now\");\n\t\t\t//remove period length\n\t\t\tvar periodLength = prevPeriod.getElementsByClassName(\"periodLength\")[0];\n\t\t\tif(periodLength) prevPeriod.removeChild(periodLength);\n\t\t}\n\t\t\n\t\t//clear previous highlighted day\n\t\t//needs to be done after getting prevPeriods, or else prevDay no longer points anywhere\n\t\tprevDay.id = \"\";\n\t}\n\n\t//set new highlighted day/period\n\tvar days = document.getElementById(\"schedule\").rows[0].cells;\n\tfor(var d=0;d<days.length;d++){\n\t\tvar day = days[d];\n\t\tif(date.valueOf() == day.date){ //test if date should be highlighted\n\t\t\t//set new highlighted day\n\t\t\tday.id = \"today\";\n\n\t\t\t//set new highlighted periods\n\t\t\tvar periods = day.getElementsByClassName(\"periodWrapper\");\n\t\t\tfor(var p=0;p<periods.length;p++){\n\t\t\t\tvar period = periods[p];\n\t\t\t\tif(time-period.start>=0 && time-period.end<0){ //test if period should be highlighted\n\t\t\t\t\tperiod.classList.add(\"now\");\n\t\t\t\t\t//add period length if it fits\n\t\t\t\t\tif((period.end-period.start)/60000>=40){\n\t\t\t\t\t\tvar length = (period.end - time) / 60000;\n\t\t\t\t\t\tperiod.innerHTML += \"<div class=\\\"periodLength\\\">\" +\n\t\t\t\t\t\t\t\t(length>1 ?\n\t\t\t\t\t\t\t\t\tMath.round(length) + \" min. left</div>\" :\n\t\t\t\t\t\t\t\t\tMath.round(length*60) + \" sec. left</div>\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif(opts.enablePeriodNotifications) {\n\t\tvar currPeriods = Array.prototype.slice.call(document.getElementsByClassName(\"now\")); //needs to be an array and not an HTML\n\n\t\tvar diff1 = currPeriods.diff(prevPeriods);\n\t\tvar diff2 = prevPeriods.diff(currPeriods);\n\n\t\tfor(var i=0; i<diff1.length; i++) {\n\t\t\tvar name = currPeriods[i].periodName;\n\t\t\tif(name && !hasFocus) sendNotification(name + \" has started.\", opts.notificationDuration);\n\t\t}\n\t\tfor(var i=0; i<diff2.length; i++) {\n\t\t\tvar name = prevPeriods[i].periodName;\n\t\t\tif(name && !hasFocus) sendNotification(name + \" has ended.\", opts.notificationDuration);\n\t\t}\n\t}\n}\n\n/**\n * Updates schedule to display as it would on the given date/time; defaults to now if none is given.\n * Also updates\n */\nfunction updateSchedule(time,force) {\n\tsetDisplayDate(time,force);\n\tsetHighlightedPeriod();\n}\nexports.updateSchedule = updateSchedule;\n\n/**\n * Creates a desktop notification with the given text for a title and removes it after the given duration in seconds.\n * A duration of 0 or less will disable auto-closing the notification.\n */\nfunction sendNotification(text, duration) {\n\tif(\"Notification\" in window) { //check that browser supports notifications\n\t\tvar notification = new Notification(text);\n\t\tif(duration > 0)\n\t\t\tsetTimeout(function() {notification.close();}, duration*1000);\n\t}\n}\n"]}