{"version":3,"file":"bundle.js","sources":["node_modules\\browserify\\node_modules\\browser-pack\\_prelude.js","main.js"],"names":["updateUrlParams","urlParams","match","pl","search","decode","s","decodeURIComponent","replace","query","location","substring","exec","initViewport","mobile","meta","document","createElement","name","content","getElementsByTagName","appendChild","class","initTitle","getElementById","addEventListener","setTitleTitle","goLast","goNext","updateSchedule","parseRawSchedule","rawSchedules","textContent","split","schedules","Array","x","length","shift","str","indexOf","start","Date","end","setDate","getDate","push","getMonth","valueOf","getFullYear","toString","substr","setDisplayDate","time","force","date","getDateFromUrlParams","setDayBeginning","displayDate","schedule","warn","getMonday","rows","deleteRow","week","insertRow","options","enableDayView","createDay","d","setFullYear","setMonth","text","warning","style","display","innerHTML","daySchedule","getDayInfo","col","insertCell","classList","add","head","headWrapper","days","getDay","dateString","prevEnd","index","i","periodName","makePeriodNameReplacements","replacements","periodTime","lastIndexOf","showPassingPeriods","passing","createPeriod","period","table","row","lunch1","lunch1Time","createSubPeriods","lunch2","lunch2Time","titles","title","Math","floor","random","setHours","getDateFromString","string","hour","min","parseInt","day","id","getScheduleIndex","undefined","parent","startDate","endDate","periodWrapper","height","start1","end1","start2","end2","p1","lunchPassing","p2","w2","updateSearch","goCurr","curr","getYear","param","slice","history","pushState","protocol","host","pathname","hash","setHighlightedPeriod","now","prevDay","prevPeriods","prototype","call","getElementsByClassName","prevPeriod","remove","periodLength","removeChild","cells","periods","p","round","enablePeriodNotifications","currPeriods","diff1","diff","diff2","hasFocus","sendNotification","notificationDuration","expandOptions","contractOptions","toggleOptions","contains","initOptions","opt","inputs","localStorage","updateScheduleInterval","activeUpdateInterval","removeItem","input","type","event","target","checked","value","createOptions","data","JSON","parse","sections","forEach","section","hasOwnProperty","platforms","createOptionSection","attachOptionActions","displayOptionsError","timeout","createOptionSectionTitle","option","createOption","tr","th","colspan","span","tddesc","tdinput","tooltip","description","defaultValue","mobileDefault","default","updateUpdateInterval","getElementsByName","permission","Notification","window","alert","requestPermission","body","scrollTo","keyCode","interceptF5","preventDefault","interceptCtrlR","ctrlKey","metaKey","setDoge","enableDoge","download","url","cb","errcb","xmlhttp","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","ontimeout","send","setUpdateInterval","hidden","hiddenUpdateInterval","inactiveUpdateInterval","seconds","clearInterval","updateScheduleID","setInterval","duration","notification","setTimeout","close","isMobile","a","navigator","userAgent","vendor","opera","innerWidth","innerHeight","test","updateClock","h","getHours","h12","m","getMinutes","addLeadingZero","n","left","scrollX","this","filter","replaceState","state"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\r\n * Primary script for the Harker Bell Schedule\r\n * Hosted at http://harkerdev.github.io/bellschedule\r\n**/\r\n\r\n/**\r\n * CSS things\r\n */\r\naddEventListener(\"scroll\", function(event) {\r\n\tdocument.getElementById(\"header\").style.left = scrollX + \"px\";\r\n});\r\n\r\n/**\r\n * Returns an array of values in the array that aren't in a.\r\n */\r\nArray.prototype.diff = function(a) {\r\n\treturn this.filter(function(i) {return a.indexOf(i) < 0;});\r\n};\r\n\r\n/**\r\n * Constants\r\n */\r\nvar days = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"]; //days of the week in string form\r\nvar schedules; //array of schedules (each schedule is an array in this array\r\nvar mobile = isMobile();\r\n\r\n/**\r\n * Globals\r\n */\r\nvar displayDate; //beginning of time period currently being displayed by the schedule\r\nvar updateScheduleID; //ID of interval of updateSchedule\r\nvar hasFocus = true; //document.hasFocus() seems to be unreliable; assumes window has focus on page load\r\nvar options = {};\r\n\r\nvar urlParams; //object with GET variables as properties and their respective values as values\r\n\r\n/**\r\n * Gets GET variables from URL and sets them as properties of the urlParams object.\r\n * Then updates the state of the current history entry with the appropriate week.\r\n */\r\n(function() {\r\n\t//decode GET vars in URL\r\n\tupdateUrlParams();\r\n\t\r\n\t//update history state\r\n\twindow.history.replaceState( getDateFromUrlParams() );\r\n}());\r\n\r\n/**\r\n * Event listeners\r\n */\r\ndocument.addEventListener(\"visibilitychange\", function(event) {\r\n\tif(!document.hidden) { //only slightly redundant; on un-minimize, document gains visibility without focus\r\n\t\tupdateSchedule();\r\n\t\t// updateClock();\r\n\t}\r\n\tupdateUpdateInterval();\r\n});\r\n\r\naddEventListener(\"focus\", function(event) {\r\n\tupdateSchedule();\r\n\t//updateClock();\r\n\r\n\thasFocus = true;\r\n\tupdateUpdateInterval();\r\n});\r\naddEventListener(\"blur\", function(event) {\r\n\thasFocus = false;\r\n\tupdateUpdateInterval();\r\n});\r\n\r\n/**\r\n * Event listener for navigating through history.\r\n * (onload event will not fire when navigating through history items pushed by history.pushState, because the page does not reload)\r\n */\r\naddEventListener(\"popstate\", function(event) {\r\n\tupdateUrlParams();\r\n\tupdateSchedule(event.state);\r\n});\r\n\r\n/**\r\n * Updates urlParams object based on the GET variables in the URL.\r\n * (variables as properties and values as values)\r\n */\r\nfunction updateUrlParams() {\r\n\turlParams = {};\r\n\t\r\n\tvar match,\r\n\t\tpl = /(?!^)\\+/g,  //regex for replacing non-leading + with space\r\n\t\tsearch = /([^&=]+)=?([^&]*)/g,\r\n\t\tdecode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); },\r\n\t\tquery = location.search.substring(1);\r\n\t\r\n\twhile (match = search.exec(query))\r\n\t\turlParams[decode(match[1])] = decode(match[2]);\r\n}\r\n\r\n/**\r\n * Parses schedules, creates schedule for correct week, sets title title on page load.\r\n */\r\naddEventListener(\"load\", function(event) {\r\n\tinitViewport();\r\n\r\n\tinitTitle();\r\n\r\n\tparseRawSchedule();\r\n\r\n\t//updateSchedule();\r\n\t//updateClock();\r\n\r\n\tdownload(\"options.json\", createOptions, displayOptionsError);\r\n});\r\n\r\nfunction initViewport() {\r\n\tif(mobile) {\r\n\t\tvar meta = document.createElement(\"meta\");\r\n\t\tmeta.name = \"viewport\";\r\n\t\tmeta.content = 'user-scalable=no, initial-scale=1.0, maximum-scale=1.0';\r\n\t\tdocument.getElementsByTagName(\"head\")[0].appendChild(meta);\r\n\t\tdocument.getElementsByTagName(\"body\")[0].class = \"mobile\";\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds appropriate event listeners to items in the schedule title.\r\n */\r\nfunction initTitle() {\r\n\tdocument.getElementById(\"header\").addEventListener(\"click\", setTitleTitle);\r\n\tdocument.getElementById(\"leftArrow\").addEventListener(\"click\", goLast);\r\n\tdocument.getElementById(\"rightArrow\").addEventListener(\"click\", goNext);\r\n\r\n\tdocument.getElementById(\"refresh\").addEventListener(\"click\", function(){ updateSchedule(null,true) });\r\n\r\n\tsetTitleTitle();\r\n}\r\n\r\n/**\r\n * Parses raw schedule in body of page into schedule array\r\n * Code is questionable\r\n */\r\nfunction parseRawSchedule() {\r\n\tvar rawSchedules=document.getElementById(\"schedules\").textContent.split(\"\\n\"); //get raw schedule text\r\n\tschedules = new Array();\r\n\tvar x=0; //index in schedules\r\n\tschedules[0] = new Array(); //create array of special schedule days\r\n\r\n\twhile(rawSchedules.length>0)\r\n\t{\r\n\t\t//loop through all lines in raw schedule text\r\n\t\tif(rawSchedules[0].length==0)\r\n\t\t{\r\n\t\t\t//if line is empty, move to next index in schedules\r\n\t\t\tschedules[++x] = new Array(); //could probably use id as index instead, or just properties\r\n\t\t\trawSchedules.shift();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t//if line has text, save in current location in schedules\r\n\t\t\tvar str = rawSchedules.shift();\r\n\t\t\tif(x==0 && str.indexOf(\"|\")>=0)\r\n\t\t\t{\r\n\t\t\t\t//behavior for blocks of dates with the same schedule\r\n\t\t\t\tvar start = new Date(str.substring(0,str.indexOf(\"|\")));\r\n\t\t\t\tvar end = new Date(str.substring(str.indexOf(\"|\")+1,str.indexOf(\"\\t\")));\r\n\t\t\t\tfor(;start<=end;start.setDate(start.getDate()+1)){\r\n\t\t\t\t\tschedules[0].push(start.getMonth().valueOf()+1+\"/\"+start.getDate()+\"/\"+start.getFullYear().toString().substr(-2)+str.substring(str.indexOf(\"\\t\")));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse schedules[x].push(str);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Displays schedule of the week of the given date/time\r\n */\r\nfunction setDisplayDate(time, force) {\r\n\tvar date = (time ? new Date(time) : getDateFromUrlParams()); //variable to keep track of current day in loop\r\n\r\n\tsetDayBeginning(date);\r\n\r\n\tif(force || !displayDate || (date.valueOf()!=displayDate.valueOf())) {\r\n\t\tvar schedule = document.getElementById(\"schedule\"); //get schedule table\r\n\r\n\t\tdisplayDate = new Date(date);\r\n\r\n\t\tif(getMonday(date) > getMonday(new Date()))\r\n\t\t\twarn(\"This is a future date, so the schedule may be incorrect. (In particular, special/alternate schedules may be missing.)\"); //display warning if date is in the future\r\n\t\telse warn(\"\"); //else display message\r\n\r\n\t\t/*\r\n\t\tif(date.valueOf()==getMonday(new Date()).valueOf()) document.getElementById(\"currWeek\").style.display = \"none\"; //hide back to current week button on current week\r\n\t\telse document.getElementById(\"currWeek\").style.display = \"inline\"; //else show the button\r\n\t\t*/\r\n\t\twhile(schedule.rows.length) schedule.deleteRow(-1); //clear existing weeks (rows); there should only be one, but just in case...\r\n\r\n\t\tvar week = schedule.insertRow(-1); //create new week (row)\r\n\r\n\t\tif(!options.enableDayView) {\r\n\t\t\tdate = getMonday(date);\r\n\t\t\tfor(var d=0;d<5;d++) {\r\n\t\t\t\t//for each day Monday through Friday (inclusive)\r\n\t\t\t\tcreateDay(week, date);\r\n\r\n\t\t\t\tdate.setDate(date.getDate()+1); //increment day\r\n\t\t\t}\r\n\t\t} else createDay(week, date);\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns a Date object based on the current urlParams (GET variables in the URL).\r\n * If any part of the date is not specified, defaults to the current date/month/year.\r\n * If in week view, uses the Monday of the week instead of the day.\r\n */\r\nfunction getDateFromUrlParams() {\r\n\tvar date = new Date();\r\n\t\r\n\tif(urlParams[\"y\"]>0) date.setFullYear(urlParams[\"y\"]);\r\n\tif(urlParams[\"m\"]>0) date.setMonth(urlParams[\"m\"]-1);\r\n\tif(urlParams[\"d\"]>0) date.setDate(urlParams[\"d\"]);\r\n\t\r\n\tif(!options.enableDayView) date = getMonday(date);\r\n\t\r\n\treturn date;\r\n}\r\n\r\n/**\r\n * Displays the given warning or hides the warning div if no warning text is given.\r\n */\r\nfunction warn(text) {\r\n\tvar warning = document.getElementById(\"warning\")\r\n\t\r\n\tif(text) warning.style.display = \"block\";\r\n\telse warning.style.display = \"none\";\r\n\t\r\n\twarning.innerHTML = text;\r\n}\r\n\r\n/**\r\n * Creates the day for the given date and appends it to the given week\r\n */\r\nfunction createDay(week, date) {\r\n\tvar daySchedule = getDayInfo(date); //get schedule for that day\r\n\r\n\tvar col = week.insertCell(-1); //create cell for day\r\n\tcol.date = date.valueOf(); //store date in cell element\r\n\r\n\tif(date.getMonth()==9 && date.getDate()==31) //check Halloween\r\n\t\tcol.classList.add(\"halloween\");\r\n\r\n\tvar head = document.createElement(\"div\"); //create header div in cell\r\n\thead.classList.add(\"head\");\r\n\tvar headWrapper = document.createElement(\"div\");\r\n\theadWrapper.classList.add(\"headWrapper\");\r\n\theadWrapper.innerHTML = days[date.getDay()] + \"<div class=\\\"headDate\\\">\" + daySchedule.dateString + /*\" (\" + daySchedule.id + \")*/\"</div>\"; //Portion commented out represents schedule id of that day\r\n\thead.appendChild(headWrapper);\r\n\tcol.appendChild(head);\r\n\r\n\tvar prevEnd = \"8:00\"; //set start of day to 8:00AM\r\n\r\n\tif(daySchedule.index > 0) { //populates cell with day's schedule (a bit messily)\r\n\t\tfor(var i=1;i<schedules[daySchedule.index].length;i++) {\r\n\t\t\tvar text = schedules[daySchedule.index][i];\r\n\t\t\tvar periodName = makePeriodNameReplacements(text.substring(0,text.indexOf(\"\\t\")), daySchedule.replacements);\r\n\t\t\tvar periodTime = text.substring(text.indexOf(\"\\t\")+1);\r\n\t\t\t\r\n\r\n\t\t\tvar start = periodTime.substring(0,periodTime.indexOf(\"-\"));\r\n\t\t\tvar end = periodTime.substring(periodTime.lastIndexOf(\"-\")+1);\r\n\r\n\t\t\tif(options.showPassingPeriods){\r\n\t\t\t\tvar passing = document.createElement(\"div\");\r\n\t\t\t\tpassing.classList.add(\"period\");\r\n\t\t\t\tcreatePeriod(passing,\"\",prevEnd,start,date);\r\n\t\t\t\tcol.appendChild(passing);\r\n\t\t\t}\r\n\r\n\t\t\tprevEnd = end;\r\n\r\n\t\t\tvar period = document.createElement(\"div\");\r\n\t\t\tperiod.classList.add(\"period\");\r\n\r\n\t\t\tif(periodName.indexOf(\"|\")>=0) {\r\n\t\t\t\t//handle split periods (i.e. lunches)\r\n\t\t\t\tvar table = document.createElement(\"table\");\r\n\t\t\t\ttable.classList.add(\"lunch\");\r\n\t\t\t\tvar row = table.insertRow(-1);\r\n\r\n\t\t\t\tvar lunch1 = row.insertCell(-1);\r\n\t\t\t\tvar lunch1Time = periodTime.substring(0,periodTime.indexOf(\"||\"));\r\n\r\n\t\t\t\tcreateSubPeriods(\r\n\t\t\t\t\t\tlunch1,\r\n\t\t\t\t\t\tperiodName.substring(0,periodName.indexOf(\"||\")),\r\n\t\t\t\t\t\tstart,\r\n\t\t\t\t\t\tlunch1Time.substring(lunch1Time.indexOf(\"-\")+1,lunch1Time.indexOf(\"|\")),\r\n\t\t\t\t\t\tlunch1Time.substring(lunch1Time.indexOf(\"|\")+1,lunch1Time.lastIndexOf(\"-\")),\r\n\t\t\t\t\t\tend,\r\n\t\t\t\t\t\tdate\r\n\t\t\t\t);\r\n\r\n\t\t\t\tvar lunch2 = row.insertCell(-1);\r\n\t\t\t\tvar lunch2Time = periodTime.substring(periodTime.indexOf(\"||\")+2);\r\n\r\n\t\t\t\tcreateSubPeriods(\r\n\t\t\t\t\t\tlunch2,\r\n\t\t\t\t\t\tperiodName.substring(periodName.indexOf(\"||\")+2),\r\n\t\t\t\t\t\tstart,\r\n\t\t\t\t\t\tlunch2Time.substring(lunch2Time.indexOf(\"-\")+1,lunch2Time.indexOf(\"|\")),\r\n\t\t\t\t\t\tlunch2Time.substring(lunch2Time.indexOf(\"|\")+1,lunch2Time.lastIndexOf(\"-\")),\r\n\t\t\t\t\t\tend,\r\n\t\t\t\t\t\tdate\r\n\t\t\t\t);\r\n\r\n\t\t\t\tperiod.appendChild(table);\r\n\t\t\t}\r\n\t\t\telse createPeriod(period,periodName,start,end,date);\r\n\t\t\tcol.appendChild(period);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns new name for period based on array of replacements.\r\n * If the current period name is listed in the array of replacements, returns the new, replaced name; otherwise, returns current name.\r\n * replacements is an array of strings of the form \"OldName->NewName\"\r\n */\r\nfunction makePeriodNameReplacements(periodName, replacements) {\r\n\tif(replacements.length > 0) {\r\n\t\tfor(var i=0;i<replacements.length;i++) {\r\n\t\t\tif(!replacements[i].indexOf(periodName))\r\n\t\t\t\treturn replacements[i].substring(replacements[i].indexOf(\"->\")+2);\r\n\t\t}\r\n\t}\r\n\treturn periodName;\r\n}\r\n\r\n/**\r\n * Sets the title of the title to a random line from the title titles list\r\n */\r\nfunction setTitleTitle() {\r\n\tvar titles = document.getElementById(\"titleTitles\").textContent.split(\"\\n\");\r\n\tdocument.getElementById(\"title\").title=titles[Math.floor(Math.random()*titles.length)];\r\n}\r\n\r\n/**\r\n * Returns the Monday of next week if date is Saturday; else returns the Monday of that week\r\n */\r\nfunction getMonday(d) {\r\n\tvar date = new Date(d);\r\n\tif(date.getDay()>=6) date.setDate(date.getDate()+2); //set date to next Monday if today is Saturday\r\n\telse date.setDate(date.getDate()-date.getDay()+1); //else set date Monday of this week\r\n\tsetDayBeginning(date); //set to beginning of day\r\n\treturn date;\r\n}\r\n\r\n/**\r\n * Sets given date to beginning of the day (12:00 AM).\r\n */\r\nfunction setDayBeginning(date) {\r\n\tdate.setHours(0,0,0,0);\r\n}\r\n\r\n/**\r\n * Takes in a date and a string of form \"hh:MM\" and turns it into a time on the day of the given date.\r\n * Assumes hours less than 7 are PM and hours 7 or greater are AM.\r\n */\r\nfunction getDateFromString(string, date) {\r\n\tvar hour = string.substring(0,string.indexOf(\":\"));\r\n\tvar min = string.substring(string.indexOf(\":\")+1);\r\n\tif(hour<7) hour = parseInt(hour,10)+12; //assumes hours less than seven are PM and hours 7 or greater are AM\r\n\treturn new Date(date.getFullYear(),date.getMonth(),date.getDate(),hour,min);\r\n}\r\n\r\n/**\r\n * For given day, returns index of schedule id in schedules, schedule id, and formatted date (mm/dd/yy).\r\n * Schedule id index is 0 if not found in schedules.\r\n */\r\nfunction getDayInfo(day) {\r\n\tvar dateString = day.getMonth().valueOf()+1 + \"/\" + day.getDate().valueOf() + \"/\" + day.getFullYear().toString().substr(-2); //format in mm/dd/YY\r\n\r\n\tvar id;\r\n\tvar index = 0;\r\n\tvar replacements = [];\r\n\t\r\n\tfor(var i=0;i<schedules[0].length;i++) //search for special schedule on day\r\n\t\tif(!schedules[0][i].indexOf(dateString)){\r\n\t\t\t//found special schedule\r\n\t\t\tif(schedules[0][i].indexOf(\"[\") >= 0) { //check for period replacements\r\n\t\t\t\t//cut replacements and space character out of id and save separately\r\n\t\t\t\tid = schedules[0][i].substring(schedules[0][i].indexOf(\"\\t\")+1,schedules[0][i].indexOf(\"[\")-1)\r\n\t\t\t\treplacements = schedules[0][i].substring(schedules[0][i].indexOf(\"[\")+1,schedules[0][i].indexOf(\"]\")).split(\",\");\r\n\t\t\t} else {\r\n\t\t\t\t// no replacements to be made\r\n\t\t\t\tid = schedules[0][i].substring(schedules[0][i].indexOf(\"\\t\")+1);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tindex = getScheduleIndex(id);\r\n\t\t}\r\n\t\r\n\tif(id === undefined) { //no special schedule found\r\n\t\tid = day.getDay();\r\n\t\tif(id==0 || id==6) index = id = 0; //no school on weekends\r\n\t\telse index = id; //default schedule for that day\r\n\t}\r\n\t\r\n\treturn { \"index\": index, \"id\": id, \"dateString\": dateString, \"replacements\": replacements };\r\n}\r\n\r\n/**\r\n * Gets the index in the list of schedules of the schedule with the given schedule id (or 0 if no matching schedules were found)\r\n */\r\nfunction getScheduleIndex(id) {\r\n\tif(id==0) return 0; //schedule id 0 represents no school\r\n\tfor(var i=1;i<schedules.length;i++) { //find index of schedule id\r\n\t\tif(id==schedules[i][0]) return i; //found specified schedule id\r\n\t}\r\n\treturn 0; //couldn't find specified schedule\r\n}\r\n\r\n/**\r\n * Creates and returns a new period wrapper with the given content and start/end times.\r\n * Also applies any special properties based on period length (text on single line if too short, block period if longer than regular).\r\n */\r\nfunction createPeriod(parent, name, start, end, date){\r\n\tstartDate = getDateFromString(start,date);\r\n\tendDate = getDateFromString(end,date);\r\n\r\n\tvar periodWrapper = document.createElement(\"div\");\r\n\tperiodWrapper.classList.add(\"periodWrapper\");\r\n\tperiodWrapper.periodName = name;\r\n\tperiodWrapper.start = startDate;\r\n\tperiodWrapper.end = endDate;\r\n\r\n\tvar length = (endDate-startDate)/60000;\r\n\r\n\tif(length > 0) {\r\n\t\tperiodWrapper.style.height = (length-1) + \"px\"; //minus 1 to account for 1px border\r\n\r\n\t\tif(length >= 15) {\r\n\t\t\tif(name) periodWrapper.innerHTML = name + (length<30 ? \" \" : \"<br />\") + start + \" – \" + end;\r\n\t\t\tif(length>50 && !name.indexOf(\"P\")) //handle block periods (class=long, i.e. bold text)\r\n\t\t\t\tperiodWrapper.classList.add(\"long\");\r\n\t\t}\r\n\r\n\treturn parent.appendChild(periodWrapper);\r\n\t}\r\n}\r\n\r\n/**\r\n * Creates and appends two new sub-periods and passing period to parent period with given start and end times.\r\n */\r\nfunction createSubPeriods(parent, name, start1, end1, start2, end2, date) {\r\n\tvar p1 = document.createElement(\"div\");\r\n\tp1.classList.add(\"period\");\r\n\tcreatePeriod(\r\n\t\t\tp1,\r\n\t\t\tname.substring(0,name.indexOf(\"|\")),\r\n\t\t\tstart1,\r\n\t\t\tend1,\r\n\t\t\tdate);\r\n\tparent.appendChild(p1);\r\n\r\n\tif(options.showPassingPeriods) {\r\n\t\tvar lunchPassing = document.createElement(\"div\");\r\n\t\tlunchPassing.classList.add(\"period\");\r\n\t\tcreatePeriod(lunchPassing,\"\",end1,start2,date);\r\n\t\tparent.appendChild(lunchPassing);\r\n\t}\r\n\r\n\tvar p2 = document.createElement(\"div\");\r\n\tp2.classList.add(\"period\");\r\n\tvar w2 = document.createElement(\"div\");\r\n\tw2.classList.add(\"periodWrapper\");\r\n\tcreatePeriod(\r\n\t\t\tp2,\r\n\t\t\tname.substring(name.indexOf(\"|\")+1),\r\n\t\t\tstart2,\r\n\t\t\tend2,\r\n\t\t\tdate);\r\n\tparent.appendChild(p2);\r\n}\r\n\r\n/**\r\n * Navigates schedule to previous date.\r\n */\r\nfunction goLast() {\r\n\tvar date = new Date(displayDate);\r\n\tdate.setDate(date.getDate() - (options.enableDayView ? 1 : 7));\r\n\tupdateSchedule(date);\r\n\t\r\n\tupdateSearch(date);\r\n}\r\n\r\n/**\r\n * Navigates schedule to next date.\r\n */\r\nfunction goNext() {\r\n\tvar date = new Date(displayDate);\r\n\tdate.setDate(date.getDate() + (options.enableDayView ? 1 : 7));\r\n\tupdateSchedule(date);\r\n\t\r\n\tupdateSearch(date);\r\n}\r\n\r\n/**\r\n * Navigates schedule to current date.\r\n */\r\nfunction goCurr() {\r\n\tvar date = new Date();\r\n\tupdateSchedule(date);\r\n\r\n\tupdateSearch(date);\r\n}\r\n\r\n/**\r\n * Updates GET variables and urlParams to reflect date in week and pushes corresponding history state.\r\n */\r\nfunction updateSearch(week, noHistory) {\r\n\tvar curr = new Date();\r\n\t\r\n\tif(!options.enableDayView) curr = getMonday(curr);\r\n\t\r\n\tif(week.getDate() != curr.getDate()) {\r\n\t\turlParams[\"m\"] = week.getMonth()+1;\r\n\t\turlParams[\"d\"] = week.getDate();\r\n\t} else {\r\n\t\tdelete urlParams[\"m\"];\r\n\t\tdelete urlParams[\"d\"];\r\n\t}\r\n\tif(week.getYear() != curr.getYear()) urlParams[\"y\"] = week.getFullYear().toString().substr(-2);\r\n\telse delete urlParams[\"y\"];\r\n\t\r\n\tvar search = \"?\";\r\n\tfor(var param in urlParams) search += param + \"=\" + urlParams[param] + \"&\";\r\n\tsearch = search.slice(0,-1);\r\n\t\r\n\thistory.pushState(week, document.title, location.protocol + \"//\" + location.host + location.pathname + search + location.hash);\r\n}\r\n\r\n/**\r\n * Highlights given date/time on the schedule; defaults to now if none is given\r\n */\r\nfunction setHighlightedPeriod(time) {\r\n\t//set default time argument\r\n\tif(!time) time = Date.now();\r\n\r\n\t//set date based on time (for finding day to highlight)\r\n\tvar date = new Date(time);\r\n\tdate.setHours(0,0,0,0);\r\n\r\n\t//clear previous highlighted day/periods\r\n\t//TODO: maybe it would be better to not clear highlights when nothing needs to be changed.\r\n\tvar prevDay = document.getElementById(\"today\");\r\n\tvar prevPeriods = [];\r\n\tif(prevDay){\r\n\t\t//clear previous highlighted periods\r\n\t\tprevPeriods = Array.prototype.slice.call(prevDay.getElementsByClassName(\"now\")); //get copy of array, not reference to it (needed to check for period changes later)\r\n\r\n\t\tfor(var i=prevPeriods.length-1;i>=0;i--){\r\n\t\t\tvar prevPeriod = prevPeriods[i];\r\n\t\t\tprevPeriod.classList.remove(\"now\");\r\n\t\t\t//remove period length\r\n\t\t\tvar periodLength = prevPeriod.getElementsByClassName(\"periodLength\")[0];\r\n\t\t\tif(periodLength) prevPeriod.removeChild(periodLength);\r\n\t\t}\r\n\t\t\r\n\t\t//clear previous highlighted day\r\n\t\t//needs to be done after getting prevPeriods, or else prevDay no longer points anywhere\r\n\t\tprevDay.id = \"\";\r\n\t}\r\n\r\n\t//set new highlighted day/period\r\n\tvar days = document.getElementById(\"schedule\").rows[0].cells;\r\n\tfor(var d=0;d<days.length;d++){\r\n\t\tvar day = days[d];\r\n\t\tif(date.valueOf() == day.date){ //test if date should be highlighted\r\n\t\t\t//set new highlighted day\r\n\t\t\tday.id = \"today\";\r\n\r\n\t\t\t//set new highlighted periods\r\n\t\t\tvar periods = day.getElementsByClassName(\"periodWrapper\");\r\n\t\t\tfor(var p=0;p<periods.length;p++){\r\n\t\t\t\tvar period = periods[p];\r\n\t\t\t\tif(time-period.start>=0 && time-period.end<0){ //test if period should be highlighted\r\n\t\t\t\t\tperiod.classList.add(\"now\");\r\n\t\t\t\t\t//add period length if it fits\r\n\t\t\t\t\tif((period.end-period.start)/60000>=40){\r\n\t\t\t\t\t\tvar length = (period.end - time) / 60000;\r\n\t\t\t\t\t\tperiod.innerHTML += \"<div class=\\\"periodLength\\\">\" +\r\n\t\t\t\t\t\t\t\t(length>1 ?\r\n\t\t\t\t\t\t\t\t\tMath.round(length) + \" min. left</div>\" :\r\n\t\t\t\t\t\t\t\t\tMath.round(length*60) + \" sec. left</div>\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif(options.enablePeriodNotifications) {\r\n\t\tvar currPeriods = Array.prototype.slice.call(document.getElementsByClassName(\"now\")); //needs to be an array and not an HTML\r\n\r\n\t\tvar diff1 = currPeriods.diff(prevPeriods);\r\n\t\tvar diff2 = prevPeriods.diff(currPeriods);\r\n\r\n\t\tfor(var i=0; i<diff1.length; i++) {\r\n\t\t\tvar name = currPeriods[i].periodName;\r\n\t\t\tif(name && !hasFocus) sendNotification(name + \" has started.\", options.notificationDuration);\r\n\t\t}\r\n\t\tfor(var i=0; i<diff2.length; i++) {\r\n\t\t\tvar name = prevPeriods[i].periodName;\r\n\t\t\tif(name && !hasFocus) sendNotification(name + \" has ended.\", options.notificationDuration);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Updates schedule to display as it would on the given date/time; defaults to now if none is given.\r\n * Also updates\r\n */\r\nfunction updateSchedule(time,force) {\r\n\tsetDisplayDate(time,force);\r\n\tsetHighlightedPeriod();\r\n}\r\n/**\r\n * Expands the options div and changes the options arrow to point down and to the right.\r\n */\r\nfunction expandOptions() {\r\n\tdocument.getElementById(\"options\").classList.add(\"expanded\");\r\n\tdocument.getElementById(\"optionsArrow\").innerHTML = \"&#8600;\";\r\n}\r\n/**\r\n * Contracts the options div and changes the options arrow to point up and to the left.\r\n */\r\nfunction contractOptions() {\r\n\tdocument.getElementById(\"options\").classList.remove(\"expanded\");\r\n\tdocument.getElementById(\"optionsArrow\").innerHTML = \"&#8598;\";\r\n}\r\n/**\r\n * Toggles the options div between extended and contracted and updates options arrow accordingly.\r\n */\r\nfunction toggleOptions() {\r\n\tif(document.getElementById(\"options\").classList.contains(\"expanded\"))\r\n\t\tcontractOptions();\r\n\telse expandOptions();\r\n\r\n}\r\n\r\n/**\r\n * Initializes automatic option saving and sets options to previously-saved values, if any.\r\n * If no previous saved value exists, sets current (default) value as saved value.\r\n */\r\nfunction initOptions() {\r\n\tvar opt = document.getElementById(\"options\");\r\n\topt.addEventListener(\"mouseover\", expandOptions);\r\n\topt.addEventListener(\"mouseout\", contractOptions);\r\n\r\n\tif(mobile) opt.classList.add(\"mobile\");\r\n\r\n\tdocument.getElementById(\"optionsArrow\").addEventListener(\"click\", toggleOptions);\r\n\r\n\tvar inputs = opt.getElementsByTagName(\"input\");\r\n\r\n\tif(localStorage.updateScheduleInterval) {\r\n\t\t//rename key\r\n\t\tlocalStorage.activeUpdateInterval=localStorage.updateScheduleInterval;\r\n\t\tlocalStorage.removeItem(\"updateScheduleInterval\");\r\n\t}\r\n\r\n\tfor(var i=0; i<inputs.length; i++)\r\n\t{\r\n\t\tvar input = inputs[i];\r\n\t\t//special cases because localStorage saves values as strings\r\n\t\tif(input.type==\"checkbox\") {\t\t\t\t\t\t\t\t\t\t\t//booleans\r\n\t\t\tinput.addEventListener(\"change\", function(event) {\r\n\t\t\t\toptions[event.target.name] = localStorage[event.target.name] = event.target.checked;\r\n\t\t\t});\r\n\r\n\t\t\tif(localStorage[input.name]) options[input.name] = input.checked = localStorage[input.name]==\"true\";\r\n\t\t\telse options[input.name] = localStorage[input.name] = input.checked;\r\n\t\t}\r\n\t\telse if(input.type==\"number\") {\t\t\t\t\t\t\t\t\t\t//numbers\r\n\t\t\tinput.addEventListener(\"change\", function(event) {\r\n\t\t\t\toptions[event.target.name] = parseInt(localStorage[event.target.name] = event.target.value);\r\n\t\t\t});\r\n\r\n\t\t\tif(localStorage[input.name]) options[input.name] = parseInt(input.value = localStorage[input.name]);\r\n\t\t\telse options[input.name] = parseInt(localStorage[input.name] = input.value);\r\n\t\t}\r\n\t\telse {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//strings\r\n\t\t\tinput.addEventListener(\"change\", function(event) {\r\n\t\t\t\toptions[event.target.name] = localStorage[event.target.name] = event.target.value;\r\n\t\t\t});\r\n\r\n\t\t\tif(localStorage[input.name]) options[input.name] = input.value = localStorage[input.name];\r\n\t\t\telse options[input.name] = localStorage[input.name] = input.value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Creates options in the options div.\r\n */\r\nfunction createOptions(data) {\r\n\t// just assume the file has everything for now\r\n\tJSON.parse(data).sections.forEach(function(section) {\r\n\t\tif(!section.hasOwnProperty(\"platforms\") ||\r\n\t\t\t((mobile && section.platforms.indexOf(\"mobile\") >= 0) || !mobile)) {\r\n\t\t\tcreateOptionSection(section);\r\n\t\t}\r\n\t});\r\n\r\n\tinitOptions();\r\n\tattachOptionActions();\r\n\r\n\tupdateSchedule(null, true);\r\n}\r\n\r\n/**\r\n * Displays error about retrieving schedule.\r\n */\r\nfunction displayOptionsError(timeout, status) {\r\n\tupdateSchedule();\r\n\t\r\n\tif(timeout) {\r\n\t\twarn(\"Retrieval of options.json timed out!\");\r\n\t} else {\r\n\t\twarn(\"Something went wrong while retrieving options.json!\");\r\n\t}\r\n}\r\n\r\n/**\r\n * Create and insert options section.\r\n */\r\nfunction createOptionSection(section) {\r\n\tcreateOptionSectionTitle(section);\r\n\tsection.options.forEach(function(option) {\r\n\t\tif(!option.hasOwnProperty(\"platforms\") ||\r\n\t\t   ((mobile && option.platforms.indexOf(\"mobile\") >= 0) || !mobile)) {\r\n\t\t\tcreateOption(option);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * Create and insert options section title.\r\n */\r\nfunction createOptionSectionTitle(section) {\r\n\tvar tr = document.createElement(\"tr\");\r\n\tvar th = document.createElement(\"th\");\r\n\tth.colspan = 2;\r\n\tif(section.hasOwnProperty(\"tooltip\")) {\r\n\t\tvar span = document.createElement(\"span\");\r\n\t\tspan.title = section[\"tooltip\"];\r\n\t\tspan.innerHTML = section.name + '<sup class=\"tooltipIndicator\">?</sup>';\r\n\t\tth.appendChild(span);\r\n\t} else {\r\n\t\tth.textContent = section.name;\r\n\t}\r\n\ttr.appendChild(th);\r\n\tdocument.getElementById(\"optionsContent\").appendChild(tr);\r\n}\r\n\r\n/**\r\n * Create and insert option into options.\r\n */\r\nfunction createOption(option) {\r\n\tvar tr = document.createElement(\"tr\");\r\n\tvar tddesc = document.createElement(\"td\");\r\n\tvar tdinput = document.createElement(\"td\");\r\n\tif(option.hasOwnProperty(\"tooltip\")) {\r\n\t\tvar span = document.createElement(\"span\");\r\n\t\tspan.title = option.tooltip;\r\n\t\tspan.innerHTML = option.description + '<sup class=\"tooltipIndicator\">?</sup>:';\r\n\t\ttddesc.appendChild(span);\r\n\t} else {\r\n\t\ttddesc.textContent = option.description + \":\";\r\n\t}\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.name = option.name;\r\n\tinput.type = option.type;\r\n\tvar defaultValue = (mobile && option.hasOwnProperty(\"mobileDefault\")) ? option.mobileDefault : option.default; //choose desktop or mobile default value\r\n\tif(input.type == \"number\") {\r\n\t\tinput.min = 0; //may as well keep this here until any options can take negative\r\n\t\tinput.value = defaultValue;\r\n\t} else if(input.type == \"checkbox\") {\r\n\t\tif(defaultValue) input.checked = \"checked\";\r\n\t}\r\n\ttdinput.appendChild(input);\r\n\ttr.appendChild(tddesc);\r\n\ttr.appendChild(tdinput);\r\n\tdocument.getElementById(\"optionsContent\").appendChild(tr);\r\n}\r\n\r\n/**\r\n * Creates event listeners for option-specific actions on option change and applies option-specific actions on page load.\r\n */\r\nfunction attachOptionActions() {\r\n\tupdateUpdateInterval();\r\n\tdocument.getElementsByName(\"activeUpdateInterval\")[0].addEventListener(\"change\", function(event) {\r\n\t\tupdateUpdateInterval();\r\n\t});\r\n\tdocument.getElementsByName(\"showPassingPeriods\")[0].addEventListener(\"change\", function(event) {\r\n\t\tupdateSchedule(null,true);\r\n\t});\r\n\r\n\tdocument.getElementsByName(\"enablePeriodNotifications\")[0].addEventListener(\"change\", function(event) {\r\n\t\tif(options.enablePeriodNotifications) {\r\n\t\t\tvar permission = Notification.permission;\r\n\t\t\tif(!(\"Notification\" in window)) {\r\n\t\t\t\talert(\"This browser does not support desktop notifications.\");\r\n\t\t\t} else if(permission == \"denied\") {\r\n\t\t\t\talert(\"Please allow desktop notifications for this site to enable this feature.\");\r\n\t\t\t} else if(permission == \"default\") {\r\n\t\t\t\tNotification.requestPermission();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tdocument.body.classList.add(options.enableDayView ? \"day\" : \"week\");\r\n\tdocument.getElementsByName(\"enableDayView\")[0].addEventListener(\"change\", function(event) {\r\n\t\tupdateSchedule(null, true);\r\n\t\t\r\n\t\tdocument.body.classList.remove(\"week\");\r\n\t\tdocument.body.classList.remove(\"day\");\r\n\t\tdocument.body.classList.add(options.enableDayView ? \"day\" : \"week\");\r\n\t\t\r\n\t\tscrollTo(0,0); //scroll back to top-left corner\r\n\t});\r\n\r\n\tif(!mobile) {\r\n\t\tdocument.addEventListener(\"keydown\", function(event) {\r\n\t\t\tswitch (event.keyCode){\r\n\t\t\t\tcase 116 : //F5\r\n\t\t\t\t\tif(options.interceptF5){\r\n\t\t\t\t\t\t//enabled\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tupdateSchedule();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 82 : //R key\r\n\t\t\t\t\tif(options.interceptCtrlR && (event.ctrlKey||event.metaKey)){\r\n\t\t\t\t\t\t//enabled and control/cmd (meta)\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tupdateSchedule();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 37 : //Left arrow\r\n\t\t\t\t\tgoLast();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 39 : //Right arrow\r\n\t\t\t\t\tgoNext();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 40 : //Down arrow\r\n\t\t\t\t\tgoCurr();\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsetDoge(options.enableDoge);\r\n\t\tdocument.getElementsByName(\"enableDoge\")[0].addEventListener(\"change\", function(event) {\r\n\t\t\tsetDoge(event.target.checked);\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * Retrieve file data via XMLHttpRequest.\r\n *\r\n * cb is for successful retrieval and takes a String as a parameter.\r\n * errcb is for an error on retrieval and takes:\r\n *    1. a boolean representing whether or not the error was a timeout.\r\n *    2. an integer representing the status of the response (this is null on timeout).\r\n */\r\nfunction download(url, cb, errcb) {\r\n\tvar xmlhttp = new XMLHttpRequest();\r\n\txmlhttp.open(\"GET\", url, true);\r\n\txmlhttp.onreadystatechange = function() {\r\n\t\tif(xmlhttp.readyState == 4) {\r\n\t\t\tif(xmlhttp.status == 200) {\r\n\t\t\t\tcb(xmlhttp.responseText);\r\n\t\t\t} else if(errcb) {\r\n\t\t\t\terrcb(false, xmlhttp.status);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\txmlhttp.ontimeout = function() {\r\n\t\terrcb(true, null);\r\n\t};\r\n\txmlhttp.send();\r\n}\r\n\r\n/**\r\n * Sets the correct update interval based on the current state (focus and visibility) of the document.\r\n */\r\nfunction updateUpdateInterval() {\r\n\tif(document.hidden) setUpdateInterval(options.hiddenUpdateInterval); //assume that hidden implies no focus\r\n\telse if(hasFocus) setUpdateInterval(options.activeUpdateInterval);\r\n\telse setUpdateInterval(options.inactiveUpdateInterval);\r\n}\r\n\r\n/**\r\n * Updates the interval for automatically refreshing the page.\r\n * seconds is the new interval in seconds.\r\n */\r\nfunction setUpdateInterval(seconds) {\r\n\tclearInterval(updateScheduleID);\r\n\tif(seconds>0)\r\n\t\tupdateScheduleID = setInterval(function() {\r\n\t\t\t//updateClock();\r\n\t\t\tupdateSchedule();\r\n\t\t}, seconds * 1000); //convert to milliseconds\r\n\telse updateScheduleID = null;\r\n}\r\n\r\n/**\r\n * Creates a desktop notification with the given text for a title and removes it after the given duration in seconds.\r\n * A duration of 0 or less will disable auto-closing the notification.\r\n */\r\nfunction sendNotification(text, duration) {\r\n\tif(\"Notification\" in window) { //check that browser supports notifications\r\n\t\tvar notification = new Notification(text);\r\n\t\tif(duration > 0)\r\n\t\t\tsetTimeout(function() {notification.close();}, duration*1000);\r\n\t}\r\n}\r\n\r\n/**\r\n * Function to detect whether the page is being displayed on a mobile device.\r\n * Currently checks if the useragent/vendor matches a regex string for mobile phones.\r\n */\r\nfunction isMobile() {\r\n\tvar a = navigator.userAgent || navigator.vendor || window.opera;\r\n\tif(window.innerWidth <= 800 && window.innerHeight <= 600) return true;\r\n\treturn /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4));\r\n}\r\n\r\n/**\r\n * Updates the time on the bell schedule\r\n */\r\nfunction updateClock() {\r\n\tvar now = new Date();\r\n\tvar h = now.getHours();\r\n\tvar h12 = h%12;\r\n\tvar m = now.getMinutes();\r\n\tdocument.getElementById('currentTime').innerHTML = (h12==0 ? 12: h12) + \":\" + addLeadingZero(m) + (h>=12 ? \" PM\" : \" AM\");\r\n}\r\n\r\n/**\r\n * Adds leading zeroes as necessary to make output (at least) 2 characters long\r\n * (Assumes that n is an integer.)\r\n */\r\nfunction addLeadingZero(n) {\r\n\treturn (n<10) ? \"0\"+n : n;\r\n}\r\n"]}